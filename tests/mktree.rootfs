#!/bin/bash
#
# Rootfs mktree backend
#
# Base: root filesystem
# RPM build: native
# Isolation of rpmtests: none
# Optimized for: build containers
# Works without cmake: no
# Requirements:
#   - root filesystem must be read-only
#   - current directory must be a host mount
#   - container must be privileged (to create mounts & namespaces)

CMD=$1; shift
case $CMD in
    build)
        source ./mktree.common
        make_install /
    ;;
    check)
        ./rpmtests "$@"
    ;;
    *) unsupported ;;
esac
